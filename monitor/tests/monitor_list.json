[{"name": "[Integration Users] All users have MFA enabled", "query": "select first_name, last_name, email, is_admin, mfa_enabled, source_system from lo_users where mfa_enabled = 'false';", "source_systems": [], "control_references": "Multi-factor authentication (MFA)\r\nIAM-001\r\nIdentification and authentication (organizational users)\r\nAWS Multi-Factor Authentication", "control_reference_ids": "IA-05\r\nIA-02", "tag_references": "224534\r\n1234567890987654321", "subtask_reference": "94f1259b-2c70-457c-8e6f-6515d7eb7b10", "validation_query": "", "description": "It's a best practice to ensure all user accounts with key vendors are secured behind multi-factor authentication (MFA). This monitor will move to a Flagged state if we detect user accounts that have MFA disabled.", "monitor_type": "system_monitor", "urgency": "low", "status": "inactive", "health_condition": "empty_results", "frequency": "daily", "runner_type": "laika_context", "take_action": "", "fix_me_link": "https://app.heylaika.com/lob/user", "exclude_field": "lo_users.id"}, {"name": "[AWS] All s3 buckets are encrypted", "query": "select\r\n  name,\r\n  arn as resource,\r\n  server_side_encryption_configuration,\r\n  region,\r\n  account_id\r\nfrom\r\n  aws_s3_bucket\r\nwhere\r\n  server_side_encryption_configuration is null;", "source_systems": ["aws"], "control_references": "Encryption at rest\r\nEncrypting Data At Rest", "control_reference_ids": "SC-13", "tag_references": "", "subtask_reference": "aef7b123-083c-41ba-8a4b-2372704a2e8d", "validation_query": "select \r\n  * \r\nfrom \r\n  lo_accounts \r\nwhere \r\n  source_system = 'Amazon Web Services (AWS)'", "description": "S3 buckets containing proprietary or customer information should always be encrypted. This Monitor will move to a flagged state if any of your buckets are not encrypted. You can customize the monitor to exclude specific buckets that can remain un-encrypted.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "<p class=\"p1\">1. Select violations from the query result and click the red \"Fix Violations\" button to open the s3 buckets in a new tab. If you've selected multiple records, your browser may request permission to open multiple tabs.&nbsp; &nbsp; &nbsp;&nbsp;</p>\r\n<p class=\"p1\">2. To enable server-side encryption for your object, select <strong>Enable </strong>under&nbsp;<strong>Server-side encryption</strong> and choose the most appropriate <strong>Encryption key type</strong> for the selected object. Then, press \"Save Changes\" and refresh this monitor to validate that the violation has been remediated.</p>\r\n<p class=\"p1\"><img src=\"https://i.imgur.com/ggn4Xro.png\" alt=\"\" width=\"816\" height=\"358\" /></p>", "fix_me_link": "https://s3.console.aws.amazon.com/s3/bucket/$aws_s3_bucket.name/property/encryption/edit?region=$aws_s3_bucket.region", "exclude_field": "aws_s3_bucket.arn"}, {"name": "[AWS] s3 buckets are not publicly available", "query": "select name, block_public_acls, block_public_policy, ignore_public_acls, restrict_public_buckets, arn, account_id from aws_s3_bucket where not block_public_acls or not block_public_policy or not ignore_public_acls or not restrict_public_buckets;", "source_systems": [], "control_references": "Encryption in transit,\r\nEncryption at rest,\r\nFirewalls on all endpoints,\r\nDCA 52 (CC6)", "control_reference_ids": "AC-06", "tag_references": "", "subtask_reference": "9d4fe0c4-9529-4bfc-9f23-2add683f546b", "validation_query": "select * from lo_accounts where source_system = 'Amazon Web Services (AWS)'", "description": "S3 buckets containing proprietary or customer information should not be accessible through public access control lists (\"ACLs\"). This monitor will returned a flagged state if any s3 bucket allows public access. Customize this monitor to exclude buckets that should be public.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://s3.console.aws.amazon.com/s3/bucket/$aws_s3_bucket.name/property/bpa/edit?region=$aws_s3_bucket.region", "exclude_field": "aws_s3_bucket.arn"}, {"name": "[AWS] All DynamoDB instances are encrypted", "query": "select\r\n  name,\r\n  table_status,\r\n  title,\r\n  sse_description\r\nfrom\r\n  aws_dynamodb_table\r\nwhere\r\n  sse_description is null;", "source_systems": null, "control_references": "Encryption at rest\r\nEncrypting Data At Rest\r\nCryptographic protection", "control_reference_ids": "SC-13", "tag_references": "", "subtask_reference": "adf335d1-b626-45c3-bc2b-d6b24e77da37\r\naef7b123-083c-41ba-8a4b-2372704a2e8d", "validation_query": "select * from lo_accounts where source_system = 'Amazon Web Services (AWS)'", "description": "All databases housing proprietary or customer information should be encrypted. This monitor will moved to a flagged status if any DynamoDB instance is not encrypted.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://console.aws.amazon.com/dynamodbv2/home?region=$aws_dynamodb_table.region#manage-encryption?table=$aws_dynamodb_table.name", "exclude_field": "aws_dynamodb_table.arn"}, {"name": "[AWS] DynamoDB instances are continuously backed up", "query": "select name, account_id, arn, continuous_backups_status from  aws_dynamodb_table where  continuous_backups_status = 'DISABLED';", "source_systems": null, "control_references": "Backup tests", "control_reference_ids": "CP-02", "tag_references": "", "subtask_reference": "a5a9e199-78aa-4c06-8dbc-f995214faad8", "validation_query": "select * from lo_accounts where source_system = 'Amazon Web Services (AWS)'", "description": "Continuous backup of production data stores is an easy way to protect against unintended data change or deletion. This monitor will move to a flagged status if any DynamoDB instance doesn't have this best practice enabled.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://console.aws.amazon.com/dynamodbv2/home?region=$aws_dynamodb_table.region#edit-pitr?table=$aws_dynamodb_table.name", "exclude_field": "aws_dynamodb_table.arn"}, {"name": "[AWS] All RDS databases are encrypted", "query": "select \r\nrds.db_instance_identifier, \r\nrds.class, \r\nrds.allocated_storage, \r\nrds.deletion_protection,\r\nrds.engine,\r\nrds.engine_version,\r\nrds.vpc_id,\r\nrds.kms_key_id,\r\nkms.key_manager,\r\nrds.storage_encrypted,\r\nrds.account_id,\r\nrds.arn\r\nfrom \r\naws_rds_db_instance as rds left join aws_kms_key as kms\r\non kms.arn = rds.kms_key_id  \r\nwhere not storage_encrypted;", "source_systems": null, "control_references": "Encryption at rest\r\nEncrypting Data At Rest\r\nCryptographic protection", "control_reference_ids": "SC-13", "tag_references": "", "subtask_reference": "adf335d1-b626-45c3-bc2b-d6b24e77da37\r\naef7b123-083c-41ba-8a4b-2372704a2e8d", "validation_query": "select * from lo_accounts where source_system = 'Amazon Web Services (AWS)'", "description": "Any database instance containing production data should be encrypted unless it's necessary for it not to be. This monitor will moved to a Flagged state if any unencrypted RDS instances are found.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://console.aws.amazon.com/rds/home?region=$aws_rds_db_instance.region#database:id=$aws_rds_db_instance.db_instance_identifier;is-cluster=false;tab=connectivity", "exclude_field": "aws_rds_db_instance.arn"}, {"name": "[AWS] RDS Databases are not publicly accessible", "query": "select  db_instance_identifier,  publicly_accessible, arn from aws_rds_db_instance where  publicly_accessible;", "source_systems": [], "control_references": "DCA 52 (CC6)", "control_reference_ids": "", "tag_references": "", "subtask_reference": "9d4fe0c4-9529-4bfc-9f23-2add683f546b", "validation_query": "select * from lo_accounts where source_system = 'Amazon Web Services (AWS)'", "description": "Any database housing proprietary or customer information should not be publicly accessible unless required. This monitor will return a Flagged status if any publicly available databases are found.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://console.aws.amazon.com/rds/home?region=$aws_rds_db_instance.region#modify-instance:id=$aws_rds_db_instance.db_instance_identifier", "exclude_field": "aws_rds_db_instance.arn"}, {"name": "[AWS] RDS cluster snapshots are encrypted", "query": "select\r\n  db_cluster_snapshot_identifier,\r\n  storage_encrypted,\r\n  db_cluster_identifier,\r\n  engine,\r\n  engine_version,\r\n  allocated_storage,\r\n  kms_key_id\r\nfrom\r\n  aws_rds_db_cluster_snapshot\r\nwhere not storage_encrypted", "source_systems": [], "control_references": "", "control_reference_ids": "CP-09\r\nCP-02", "tag_references": "", "subtask_reference": "a5a9e199-78aa-4c06-8dbc-f995214faad8", "validation_query": "select * from lo_accounts where source_system = 'Amazon Web Services (AWS)'", "description": "This monitor verifies that your AWS RDS cluster snapshots are encrypted. It will move to a Flagged status if unencrypted cluster snapshots are found.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://us-east-2.console.aws.amazon.com/rds/home?region=$aws_rds_db_cluster_snapshot.region#snapshots-list:", "exclude_field": "aws_rds_db_cluster_snapshot.arn"}, {"name": "[AWS] All secrets automatically rotate", "query": "select name, created_date, description, rotation_enabled, policy, region from aws_secretsmanager_secret where not rotation_enabled;", "source_systems": [], "control_references": "Encryption key rotation", "control_reference_ids": "AC-06", "tag_references": "", "subtask_reference": "2e482fd7-d2c4-4b92-9d9a-f51e5cb79dcc", "validation_query": "select * from lo_accounts where source_system = 'Amazon Web Services (AWS)'", "description": "All important AWS secrets should rotate periodically in order to mitigate your organization's security risk. This monitor will move to a Flagged state if any secret is found that does not automatically rotate.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://$aws_secretsmanager_secret.region.console.aws.amazon.com/secretsmanager/home?region=$aws_secretsmanager_secret.region#!/secret?name=$aws_secretsmanager_secret.name", "exclude_field": "aws_secretsmanager_secret.arn"}, {"name": "[AWS] CloudTrail is configured", "query": "select  name,  home_region,  is_multi_region_trail from  aws_cloudtrail_trail limit 10", "source_systems": null, "control_references": "System activity logs\r\nApplication logs", "control_reference_ids": "AU-02\r\nAU-06\r\nSI-04", "tag_references": "", "subtask_reference": "", "validation_query": "select * from lo_accounts where source_system = 'Amazon Web Services (AWS)'", "description": "Enabling AWS CloudTrail is an easy way to log, continuously monitor, and retain account activity related to actions across your AWS infrastructure. This monitor will move to a Flagged state if no trails are found.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "return_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://console.aws.amazon.com/cloudtrail/homeregion=$aws_cloudtrail_trail.home_region#/dashboard", "exclude_field": "aws_cloudtrail_trail.arn"}, {"name": "[AWS] All users have MFA enabled", "query": "SELECT * from lo_users where source_system = 'Amazon Web Services (AWS)' and mfa_enabled = 'false'", "source_systems": [], "control_references": "Multi-factor authentication (MFA),\r\nDCA 39 (CC6)\r\nIdentification and authentication (organizational users)", "control_reference_ids": "IA-05\r\nIA-02", "tag_references": "", "subtask_reference": "94f1259b-2c70-457c-8e6f-6515d7eb7b10", "validation_query": "select * from lo_accounts where source_system = 'Amazon Web Services (AWS)'", "description": "All AWS users should have MFA enabled. This monitor will move to a Flagged state if any AWS user doesn't have MFA enabled.", "monitor_type": "system_monitor", "urgency": "low", "status": "inactive", "health_condition": "empty_results", "frequency": "daily", "runner_type": "laika_context", "take_action": "", "fix_me_link": "https://app.heylaika.com/lob/user", "exclude_field": "lo_users.id"}, {"name": "[Devices] All devices are encrypted", "query": "select * from lo_devices where encryption_status = 'Not encrypted'", "source_systems": null, "control_references": "Server Side Encryption", "control_reference_ids": "SC-13\r\nPS-01\r\nSC-07", "tag_references": "", "subtask_reference": "aef7b123-083c-41ba-8a4b-2372704a2e8d", "validation_query": "", "description": "All devices used in the course of typical business should be encrypted by default. This protects your company from data extraction if the device falls into the wrong hands. This monitor will move to a Flagged state if any unencrypted device is found in the Objects table.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "laika_context", "take_action": "", "fix_me_link": "https://app.heylaika.com/lob/device", "exclude_field": "lo_devices.id"}, {"name": "[Accounts] Cloud infrastructure connected to Laika", "query": "Select source_system, is_active, connection_name, created_on from lo_accounts where source_system IN ('Amazon Web Services (AWS)', 'Google Cloud Platform (GCP)', 'Microsoft Azure', 'Heroku') and is_active = 'true'", "source_systems": [], "control_references": "", "control_reference_ids": "", "tag_references": "", "subtask_reference": "", "validation_query": "", "description": "Laika encourages all customers to connect to their cloud service providers in order to maximize the benefit you get from our platform. This monitor will move to a Flagged state if we don't detect a connection.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "return_results", "frequency": "daily", "runner_type": "laika_context", "take_action": "", "fix_me_link": "https://app.heylaika.com/integrations?activeTab=standard", "exclude_field": "lo_accounts.created_on"}, {"name": "[Integration Users] All Github users have MFA", "query": "SELECT * from lo_users where source_system = 'GitHub Apps' and mfa_enabled = 'False'", "source_systems": [], "control_references": "Multi-factor authentication (MFA)\r\nIdentification and authentication (organizational users)\r\nAWS Multi-Factor Authentication", "control_reference_ids": "IA-05\r\nIA-02", "tag_references": "", "subtask_reference": "94f1259b-2c70-457c-8e6f-6515d7eb7b10", "validation_query": "select * from lo_accounts where source_system LIKE '%Github%'", "description": "It's a best practice to ensure all user accounts with key vendors are secured behind multi-factor authentication (MFA). This monitor will move to a Flagged state if we detect user accounts at Github that have MFA disabled.", "monitor_type": "system_monitor", "urgency": "low", "status": "inactive", "health_condition": "empty_results", "frequency": "daily", "runner_type": "laika_context", "take_action": "", "fix_me_link": "https://github.com/settings/security", "exclude_field": "lo_users.id"}, {"name": "[Accounts] MDM software connected to Laika", "query": "Select * from lo_accounts where source_system IN ('Jamf', 'Rippling') and is_active = 'true'", "source_systems": [], "control_references": "DCA 48 (CC6)", "control_reference_ids": "", "tag_references": "", "subtask_reference": "", "validation_query": "", "description": "Mobile device management (\"MDM\") software allows businesses to configure and secure devices such as smartphones, tablets, and computers. Connecting your MDM provider to Laika allows us to continuously monitor the encryption status of each device. This monitor will move to a Flagged state if no MDM software is integrated with Laika.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "return_results", "frequency": "daily", "runner_type": "laika_context", "take_action": "", "fix_me_link": "https://app.heylaika.com/integrations?activeTab=standard", "exclude_field": ""}, {"name": "[Repositories] All Repositories are private", "query": "SELECT * from lo_repositories where is_public = 'true'", "source_systems": [], "control_references": "Code Repository and Tracking", "control_reference_ids": "AC-06", "tag_references": "", "subtask_reference": "", "validation_query": "", "description": "Code repositories in your version control system should not be accessible via the open internet in order to protect intellectual property. This monitor will move to a Flagged state if any public repository is found.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "laika_context", "take_action": "", "fix_me_link": "https://app.heylaika.com/lob/repository", "exclude_field": "lo_repositories.name"}, {"name": "[AWS] Config is enabled", "query": "select\r\n  name,\r\n  role_arn,\r\n  status,\r\n  recording_group,\r\n  status_recording,\r\n  akas,\r\n  title,\r\n  region\r\nfrom\r\n  aws_config_configuration_recorder", "source_systems": [], "control_references": "", "control_reference_ids": "AU-02", "tag_references": "", "subtask_reference": "", "validation_query": "select * from lo_accounts where source_system = 'Amazon Web Services (AWS)'", "description": "AWS Config is a powerful tool that continuously monitors and records your AWS resource configurations. Config also allows you to automate the evaluation of recorded configurations against desired configurations to ensure security policies are implemented correctly. This monitor will move to a Flagged state if Config is not being used.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "return_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://console.aws.amazon.com/config/home?region=$aws_config_configuration_recorder.region#/settings", "exclude_field": "aws_config_configuration_recorder.arn"}, {"name": "[AWS] CloudWatch alarms are configured", "query": "select\r\n  name,\r\n  title,\r\n  state_value,\r\n  metric_name,\r\n  actions_enabled,\r\n  comparison_operator,\r\n  namespace,\r\n  statistic\r\nfrom\r\n  aws_cloudwatch_alarm limit 100", "source_systems": null, "control_references": "Security incident monitoring,\r\nBackup failure alerts,\r\nIntrusion detection system (IDS),\r\nSystem activity logs,\r\nApplication logs,\r\nDCA 54 (CC6, CC7, CC9)", "control_reference_ids": "AU-02\r\nAU-06\r\nSI-04", "tag_references": "", "subtask_reference": "", "validation_query": "select * from lo_accounts where source_system = 'Amazon Web Services (AWS)'", "description": "AWS CloudWatch alarms can continuously monitor any AWS resource for abnormal behavior. When abnormal behavior is detected, CloudWatch can trigger custom actions like alerts to help your organization respond to the suspicious behavior. This monitor will move to a Flagged state if no alarms are configured in your AWS account.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "return_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://console.aws.amazon.com/cloudwatch/home?region=$aws_cloudwatch_alarm.region#alarmsV2:", "exclude_field": "aws_cloudwatch_alarm.arn"}, {"name": "[Azure] Active Directory groups have security defaults enabled", "query": "select\r\n  display_name,\r\n  object_id,\r\n  security_enabled\r\nfrom\r\n  azure_ad_group\r\nwhere\r\n  not security_enabled;", "source_systems": null, "control_references": "DCA 30 (CC3, CC5, CC6)", "control_reference_ids": "AC-06", "tag_references": "", "subtask_reference": "76a38e7a-8e79-4298-9d21-00a75ea6aa01", "validation_query": "select * from lo_accounts where source_system = 'Microsoft Azure'", "description": "Azure has a grouped set of default security configurations which should be enabled on all Azure Active Directory groups. When enabled, these recommendations will be automatically enforced throughout your subscription. This monitor will moved to a Flagged condition if any AD group is found without these security defaults enabled. In order to enable security defaults, go to the Azure Active Directory's \"Properties\" menu and press the \"Manage Security defaults\" link at the bottom of the page.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://portal.azure.com/#blade/Microsoft_AAD_IAM/GroupsManagementMenuBlade/AllGroups", "exclude_field": "azure_ad_group.object_id"}, {"name": "[Azure] No custom subscription IAM roles exist", "query": "select\r\n    role_name,\r\n    role_type,\r\n    title,\r\n    action,\r\n    subscription_id\r\n  from\r\n    azure_role_definition,\r\n    jsonb_array_elements(permissions) as s,\r\n    jsonb_array_elements_text(s -> 'actions') as action\r\n  where\r\n    role_type = 'CustomRole'\r\n    and action in ('*', '*:*')", "source_systems": null, "control_references": "", "control_reference_ids": "AC-03\r\nIA-05", "tag_references": "", "subtask_reference": "76a38e7a-8e79-4298-9d21-00a75ea6aa01", "validation_query": "select * from lo_accounts where source_system = 'Microsoft Azure'", "description": "All subscription IAM roles should adhere to the principle of least privilege. Default subscription roles offer basic access management and should cover most use cases. Specific permissions can be added for users that require additional access, but should not be added using wildcard actions. This monitor will moved to a Flagged condition if any custom roles are detected at the subscription level.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/RolesAndAdministrators", "exclude_field": "azure_role_definition.akas"}, {"name": "[Azure] Storage accounts are not publicly available", "query": "select subscription_id, resource_group, name, type, access_tier, kind, allow_blob_public_access, enable_https_traffic_only, creation_time \r\nfrom azure_storage_account\r\nwhere allow_blob_public_access = 'true'", "source_systems": [], "control_references": "", "control_reference_ids": "", "tag_references": "", "subtask_reference": "9d4fe0c4-9529-4bfc-9f23-2add683f546b", "validation_query": "select * from lo_accounts where source_system = 'Microsoft Azure'", "description": "Azure storage accounts should not be publicly accessible unless they are required to be. This monitor will move to a Flagged condition if any storage account allows public access. Storage accounts that require public access should be added as exceptions to this monitor.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://portal.azure.com/#@/resource/subscriptions/$azure_storage_account.subscription_id/resourceGroups/$azure_storage_account.resource_group/providers/Microsoft.Storage/storageAccounts/$azure_storage_account.name/configuration", "exclude_field": "azure_storage_account.akas"}, {"name": "[Azure] Storage accounts enforce encryption in transit", "query": "select subscription_id, resource_group, name, type, access_tier, kind, allow_blob_public_access, enable_https_traffic_only \r\nfrom azure_storage_account\r\nwhere enable_https_traffic_only = 'false'", "source_systems": [], "control_references": "", "control_reference_ids": "SC-13", "tag_references": "", "subtask_reference": "461d35e8-5204-4405-9117-b62eb009866f\r\n05a8d1cc-8334-410d-b46a-81d5eb42614d\r\n7eeccf3a-f8b1-45ca-88d0-7a2ba87affa4\r\n", "validation_query": "select * from lo_accounts where source_system = 'Microsoft Azure'", "description": "Requiring storage account access over HTTPS enhances the security of a storage account by preventing data to be transmitted in an unencrypted state. This monitor will move to a Flagged condition if any storage account does not enforce HTTPS traffic.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://portal.azure.com/#@/resource/subscriptions/$azure_storage_account.subscription_id/resourceGroups/$azure_storage_account.resource_group/providers/Microsoft.Storage/storageAccounts/$azure_storage_account.name/accountEncryption", "exclude_field": "azure_storage_account.akas"}, {"name": "[Azure] Storage containers do not allow public access", "query": "select id, name, resource_group, default_encryption_scope, public_access from azure_storage_container\r\nwhere public_access != 'None'", "source_systems": [], "control_references": "", "control_reference_ids": "", "tag_references": "", "subtask_reference": "9d4fe0c4-9529-4bfc-9f23-2add683f546b", "validation_query": "select * from lo_accounts where source_system = 'Microsoft Azure'", "description": "Azure storage containers organize a set of storage accounts which can inherit security configurations from the container. Unless a specific container and all storage accounts within it require public access, it should be disabled by default. This monitor will moved to a Flagged condition if any container is detected which allows public access.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://portal.azure.com/#@/resource/subscriptions/$azure_storage_container.subscription_id/resourceGroups/$azure_storage_container.resource_group/providers/Microsoft.Storage/storageAccounts/$azure_storage_container.name/configuration", "exclude_field": "azure_storage_container.akas"}, {"name": "[Azure] Storage account denies network access by default", "query": "select subscription_id, name, id, resource_group, network_rule_default_action from azure_storage_account\r\nwhere network_rule_default_action = 'Allow'", "source_systems": [], "control_references": "", "control_reference_ids": "AC-06", "tag_references": "", "subtask_reference": "724ef00e-cb65-4e94-a726-dd1a7b58467c\r\n9d4fe0c4-9529-4bfc-9f23-2add683f546b\r\n76a38e7a-8e79-4298-9d21-00a75ea6aa01\r\na68644a3-fff7-45f8-ae75-8303a23a8a11", "validation_query": "select * from lo_accounts where source_system = 'Microsoft Azure'", "description": "Storage accounts should be configured to prohibit all connections that do not originate from explicitly white-listed sources. Access can be granted from specific Azure VPCs or public IPs where required. This monitor will moved to a Flagged condition if any storage account permits connections from clients on any network. This configuration is not enabled by default on storage accounts. It can be changed by going to the Security + networking > Networking > Firewalls and virtual networks path in the storage account menu and ensuring that access is allowed only from \"Selected networks\".", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://portal.azure.com/#@/resource/subscriptions/$azure_storage_account.subscription_id/resourceGroups/$azure_storage_account.resource_group/providers/Microsoft.Storage/storageAccounts/$azure_storage_account.name/networking", "exclude_field": "azure_storage_account.akas"}, {"name": "[Azure] All storage accounts are protected by soft deletion", "query": "select subscription_id, name, id, resource_group, blob_soft_delete_enabled, blob_soft_delete_retention_days from azure_storage_account\r\nwhere blob_soft_delete_enabled = 'false' or blob_soft_delete_retention_days < 7", "source_systems": [], "control_references": "", "control_reference_ids": "CP-02", "tag_references": "", "subtask_reference": "a5a9e199-78aa-4c06-8dbc-f995214faad8", "validation_query": "select * from lo_accounts where source_system = 'Microsoft Azure'", "description": "Enabling soft deletion and retaining storage account snapshots can protect against accidental modification or deletion of sensitive data. If this feature is not enabled, deletion leads to irretrievable data loss. This monitor will move to a Flagged condition if any storage account does not not have soft deletion enabled, or if any storage account retains backups for less than 7 days.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "<div class=\"heading-wrapper h3\">\r\n<h3 id=\"Using-the-Azure-portal\" data-renderer-start-pos=\"911\">Using the Azure portal</h3>\r\n</div>\r\n<p data-renderer-start-pos=\"935\">Select the resource and click <strong>Manage</strong></p>\r\n<ol class=\"ak-ol\" data-indent-level=\"1\">\r\n<li>\r\n<p data-renderer-start-pos=\"957\">Click on the name your Storage Account from the list</p>\r\n</li>\r\n<li>\r\n<p data-renderer-start-pos=\"984\">Click <strong data-renderer-mark=\"true\">Data Protection.</strong></p>\r\n</li>\r\n<li>\r\n<p data-renderer-start-pos=\"1014\">Enable the checkbox named <strong>Enable soft delete for blobs</strong>.</p>\r\n</li>\r\n</ol>\r\n<p>&nbsp;</p>", "fix_me_link": "https://portal.azure.com/#@/resource/subscriptions/$azure_storage_account.subscription_id/resourceGroups/$azure_storage_account.resource_group/providers/Microsoft.Storage/storageAccounts/$azure_storage_account.name/dataProtection", "exclude_field": "azure_storage_account.id"}, {"name": "[Azure] SQL Servers have auditing enabled", "query": "select subscription_id, resource_group, name, id, type, state, kind, location, audit -> 'properties' ->> 'state' as audit_state, audit -> 'properties' ->> 'retentionDays' as audit_log_retention_days, server_security_alert_policy, server_vulnerability_assessment, firewall_rules, encryption_protector  from azure_sql_server, jsonb_array_elements(server_audit_policy) audit\r\nwhere audit -> 'properties' ->> 'state' = 'Disabled'\r\nor\r\n(audit -> 'properties' ->> 'retentionDays')::integer < 365", "source_systems": [], "control_references": "", "control_reference_ids": "AU-02", "tag_references": "", "subtask_reference": "74a1fdf3-371e-45aa-bee1-c3483e28bce6\r\n1abcfbbe-504b-4967-b6f0-bc33b98348d2\r\n0c9d6cae-0e9b-4ba4-b0f7-24005e84294a", "validation_query": "select * from lo_accounts where source_system = 'Microsoft Azure'", "description": "Auditing at the SQL server level ensures that all databases on the SQL server instance create audit logs. Auditing tracks database events and writes them to an audit log in a storage account. By default, auditing is disabled for SQL servers and can be enabled in the Security > Auditing section of the SQL Server menu, or via CLI. This monitor will move to a Flagged condition if any SQL server is detected with auditing disabled or where audit logs are kept for less than 365 days.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Sql%2Fservers", "exclude_field": "azure_sql_server.akas"}, {"name": "[Azure] Sql Databases are encrypted by default", "query": "select subscription_id, name, server_name, status, transparent_data_encryption -> 'status' as transparent_data_encryption, resource_group, region, subscription_id from azure_sql_database\r\nwhere transparent_data_encryption ->> 'status'= 'Disabled'", "source_systems": [], "control_references": "Cryptographic protection", "control_reference_ids": "SC-13", "tag_references": "", "subtask_reference": "1f8a5ffb-f3ae-4632-a006-cd4b122be40b\r\nadf335d1-b626-45c3-bc2b-d6b24e77da37\r\n1b5d7a4c-695c-4028-800c-40497c1c9c09\r\n0d85c20f-deed-4893-8483-cb6c5cf99cee\r\naef7b123-083c-41ba-8a4b-2372704a2e8d\r\n", "validation_query": "select * from lo_accounts where source_system = 'Microsoft Azure'", "description": "Azure SQL database transparent data encryption performs real-time encryption and decryption of the database, associated backups and transaction log files at rest without requiring changes to the application. It's recommended that this configuration remain enabled at all time. This monitor will move to a Flagged condition if any database is found where transparent data encryption is disabled.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://portal.azure.com/#@/resource/subscriptions/$azure_sql_database.subscription_id/resourceGroups/$azure_sql_database.resource_group/providers/Microsoft.Sql/servers/$azure_sql_database.server_name/databases/$azure_sql_database.name/tde", "exclude_field": "azure_sql_database.akas"}, {"name": "[GCP] SQL Databases prohibit access from the open internet", "query": "select * from gcp_sql_database_instance gsdi \r\nwhere ip_configuration -> 'authorizedNetworks' @> '[{\"name\": \"internet\", \"value\": \"0.0.0.0/0\"}]'", "source_systems": null, "control_references": "", "control_reference_ids": "AC-06", "tag_references": "", "subtask_reference": "9d4fe0c4-9529-4bfc-9f23-2add683f546b\r\n724ef00e-cb65-4e94-a726-dd1a7b58467c", "validation_query": "SELECT * from lo_accounts where source_system = 'Google Cloud Platform (GCP)'", "description": "Production databases should only accept incoming connections from trusted IP addresses. IP addresses should be explicitly whitelisted if the database needs to be accessed from outside of your GCP organization. If your database includes '0.0.0.0/0' in it's permitted IP addresses, this means anyone on the internet can access the database. Note that this only applies to database instances with public IPs. This monitor will move to flagged if any databases allow incoming connections from '0.0.0.0/0'.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "<h3 id=\"from-console\" class=\"text-break\">From GCP Console</h3>\r\n<ol>\r\n<li>Login in to&nbsp;<a href=\"https://console.cloud.google.com/sql/instances\">Cloud SQL Instances</a></li>\r\n<li>Select the SQL Server instance to open details page.</li>\r\n<li>Under&nbsp;<strong>Configuration</strong>&nbsp;section</li>\r\n<li>Click on&nbsp;<strong>Edit Configurations</strong></li>\r\n<li>In the edit page, navigate to&nbsp;<strong>Flags and Parameters</strong>&nbsp;section</li>\r\n<li>Under&nbsp;<code>Configuration</code>&nbsp;options expand the&nbsp;<code>Connections</code>&nbsp;section.</li>\r\n<li>Click the delete icon for the authorized network 0.0.0.0/0.</li>\r\n<li>Click Save to update the instance</li>\r\n</ol>", "fix_me_link": "https://console.cloud.google.com/sql/instances/$gcp_sql_database_instance.name/connections/networking?project=$gcp_sql_database_instance.project", "exclude_field": "gcp_sql_database_instance.akas"}, {"name": "[GCP] Logging is configured", "query": "select project, name, location from gcp_logging_bucket limit 10", "source_systems": [], "control_references": "System activity logs\r\nApplication logs", "control_reference_ids": "AU-02", "tag_references": "", "subtask_reference": "0c9d6cae-0e9b-4ba4-b0f7-24005e84294a\r\n1abcfbbe-504b-4967-b6f0-bc33b98348d2\r\n74a1fdf3-371e-45aa-bee1-c3483e28bce6\r\n68c9dcf8-9a73-446c-91c7-03fd60dc6f5d", "validation_query": "SELECT * from lo_accounts where source_system = 'Google Cloud Platform (GCP)'", "description": "Enabling GCP Logging is an easy way to log, continuously monitor, and retain account activity related to actions across your GCP infrastructure. This monitor will move to a Flagged state if no logs are found.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "return_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "<h3 id=\"from-console\" class=\"text-break\">From Console</h3>\r\n<ol>\r\n<li>Login to GCP console and navigate to&nbsp;<a href=\"https://console.cloud.google.com/iam-admin/audit\">IAM &amp; Admin</a>.</li>\r\n<li>Click on&nbsp;<strong>Default Audit Config</strong>&nbsp;at the top of the page.</li>\r\n<li>In the&nbsp;<strong>LOG TYPE</strong>&nbsp;tab, select the check boxes&nbsp;<code>Admin Read</code>,&nbsp;<code>Data Read</code>, and&nbsp;<code>Data Write</code>, and click&nbsp;<strong>Save</strong>.</li>\r\n<li>In the&nbsp;<strong>EXEMPTED USERS</strong>&nbsp;tab, remove all users if any. Click&nbsp;<strong>Save</strong>.</li>\r\n</ol>\r\n<p>For more details, you can refer&nbsp;<a href=\"https://cloud.google.com/logging/docs/audit/configure-data-access\">Configuring Data Access audit logs guide</a></p>", "fix_me_link": "https://console.cloud.google.com/logs/storage?authuser=0&project=$gcp_logging_bucket.project", "exclude_field": "gcp_logging_bucket.akas"}, {"name": "[GCP] All secrets automatically rotate", "query": "select name, rotation_period, next_rotation_time, key_ring_name, create_time, iam_policy, purpose from gcp_kms_key where rotation_period is NULL", "source_systems": [], "control_references": "Encryption key rotation", "control_reference_ids": "IA-05", "tag_references": "", "subtask_reference": "2e482fd7-d2c4-4b92-9d9a-f51e5cb79dcc", "validation_query": "SELECT * from lo_accounts where source_system = 'Google Cloud Platform (GCP)'", "description": "All important GCP secrets should rotate periodically in order to mitigate your organization's security risk. This monitor will move to a Flagged state if any secret is found that does not automatically rotate.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "<p>View this document to set up automatic secret rotation.</p>\r\n<p>https://cloud.google.com/secret-manager/docs/secret-rotation</p>", "fix_me_link": "https://console.cloud.google.com/security/secret-manager?referrer=search&authuser=0&project=$gcp_kms_key.project", "exclude_field": "gcp_kms_key.akas"}, {"name": "[GCP] All users have MFA enabled", "query": "SELECT * from lo_users where source_system = 'Google Cloud Platform (GCP)' and mfa_enabled = 'false' and roles is NULL", "source_systems": [], "control_references": "Multi-factor authentication (MFA)\r\nIdentification and authentication (organizational users)", "control_reference_ids": "IA-05\r\nIA-02", "tag_references": "", "subtask_reference": "94f1259b-2c70-457c-8e6f-6515d7eb7b10", "validation_query": "SELECT * from lo_accounts where source_system = 'Google Cloud Platform (GCP)'", "description": "All GCP users should have MFA enabled. This monitor will move to a Flagged state if any GCP user doesn't have MFA enabled.", "monitor_type": "system_monitor", "urgency": "low", "status": "inactive", "health_condition": "empty_results", "frequency": "daily", "runner_type": "laika_context", "take_action": "<p>For each Google Cloud Platform project, folder, or organization</p>\r\n<ul>\r\n<li>Manually verify that multi-factor authentication for each account is set.</li>\r\n</ul>\r\n<p>Refer&nbsp;<a href=\"https://support.google.com/accounts/answer/6103523\">here</a>&nbsp;for more details.</p>", "fix_me_link": "", "exclude_field": "lo_users.id"}, {"name": "[GCP] Cloud monitoring is configured", "query": "Select name, title, location, project, notification_channels, enabled from gcp_monitoring_alert_policy", "source_systems": [], "control_references": "Security incident monitoring\r\nBackup failure alerts\r\nIntrusion detection system (IDS)\r\nSystem activity logs\r\nApplication logs", "control_reference_ids": "AU-02", "tag_references": "", "subtask_reference": "74a1fdf3-371e-45aa-bee1-c3483e28bce6\r\n0c9d6cae-0e9b-4ba4-b0f7-24005e84294a\r\n1abcfbbe-504b-4967-b6f0-bc33b98348d2\r\nf37b28b0-58c0-4ecc-b7d7-2fe2aea91bb7", "validation_query": "select * from lo_accounts where source_system = 'Google Cloud Platform (GCP)'", "description": "GCP Cloud Monitoring can continuously monitor any GCP resource for abnormal behavior. When abnormal behavior is detected, GCP Cloud Monitoring can trigger custom actions like alerts to help your organization respond to suspicious behavior. This monitor will move to a Flagged state if no alarms are configured in your GCP account.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "return_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "<h3 id=\"from-console\" class=\"text-break\">From GCP Console</h3>\r\n<ol>\r\n<li>Login to GCP console and navigate to the <strong><a href=\"https://console.cloud.google.com/monitoring/alerting?authuser=1\" target=\"_blank\" rel=\"noopener\">Alerting </a></strong><a href=\"https://console.cloud.google.com/monitoring/alerting\" target=\"_blank\" rel=\"noopener\">section within </a><strong><a href=\"https://console.cloud.google.com/monitoring/alerting?authuser=1\" target=\"_blank\" rel=\"noopener\">Monitoring</a>.</strong></li>\r\n<li>Click on&nbsp;<strong>Create Policy</strong> on the right side of the page.</li>\r\n<li>Create the desired policy via the wizard.</li>\r\n<li>Click <strong>Save</strong>.</li>\r\n</ol>", "fix_me_link": "https://console.cloud.google.com/monitoring/alerting/policies?referrer=search&project=$gcp_monitoring_alert_policy.project", "exclude_field": "gcp_monitoring_alert_policy.akas"}, {"name": "[GCP] All Compute Instances are using non-default service accts", "query": "select \r\n name, \r\n status, \r\n description, \r\n location, \r\n machine_type, \r\n self_link, \r\n service_accounts, \r\n accounts ->> 'email' as email,\r\n zone_name, \r\n labels,\r\n project\r\n from gcp_compute_instance gci, jsonb_array_elements(service_accounts) accounts\r\n where accounts ->> 'email' like '%-compute@developer.gserviceaccount.com'\r\nand not (name like 'gke-%' or labels ? 'goog-gke-node')", "source_systems": [], "control_references": "", "control_reference_ids": "AC-06", "tag_references": "", "subtask_reference": "76a38e7a-8e79-4298-9d21-00a75ea6aa01", "validation_query": "select * from lo_accounts where source_system LIKE '%GCP%'", "description": "The default Compute Engine service account has Editor permissions on all resources within your GCP project. This means it can read and write access to most Google Cloud Services. In the event your server were to be compromised, an intruder could gain the same access to all resources in your project. For that reason, it's recommended to assign a service account to your VM containing only the permissions required by the VM. This monitor will move to a flagged status if any VM is using the default service account.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://console.cloud.google.com/compute/instancesEdit/zones/$gcp_compute_instance.zone_name/instances/$gcp_compute_instance.name?project=$gcp_compute_instance.project", "exclude_field": "gcp_compute_instance.akas"}, {"name": "[GCP] All Compute Instances have explicit scopes", "query": "select name, project, accounts -> 'scopes' ? 'https://www.googleapis.com/auth/cloud-platform' as excessive_scope from gcp_compute_instance gci, jsonb_array_elements(service_accounts) accounts\r\nwhere accounts -> 'scopes' ? 'https://www.googleapis.com/auth/cloud-platform'\r\nand not (name like 'gke-%' or labels ? 'goog-gke-node')", "source_systems": [], "control_references": "", "control_reference_ids": "AC-06", "tag_references": "", "subtask_reference": "76a38e7a-8e79-4298-9d21-00a75ea6aa01\r\n9d4fe0c4-9529-4bfc-9f23-2add683f546b", "validation_query": "select * from lo_accounts where source_system LIKE '%GCP%'", "description": "The \"https://www.googleapis.com/auth/cloud-platform\" scope indicates that a VM's service account has full access to all Google Cloud APIs. In practice, this is typically more access than the service account requires. Instead, service accounts should be granted permissions explicitly to only those IAM roles that are required for their function. This monitor will move to a flagged status if any VM's service account possesses this scope.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://console.cloud.google.com/compute/instancesEdit/zones/$gcp_compute_instance.zone_name/instances/$gcp_compute_instance.name?project=$gcp_compute_instance.project", "exclude_field": "gcp_compute_instance.id"}, {"name": "[AWS] Strong password requirements are enforced", "query": "select\r\n  account_id,\r\n  allow_users_to_change_password,\r\n  expire_passwords,\r\n  hard_expiry,\r\n  max_password_age,\r\n  minimum_password_length,\r\n  password_reuse_prevention,\r\n  require_lowercase_characters,\r\n  require_numbers,\r\n  require_symbols,\r\n  require_uppercase_characters\r\nfrom\r\n  aws_iam_account_password_policy\r\nwhere password_reuse_prevention = 0\r\nor\r\nminimum_password_length < 8", "source_systems": [], "control_references": "", "control_reference_ids": "IA-05\r\nAC-01\r\nIA-02", "tag_references": "DCA 39 (CC6)", "subtask_reference": "26cbcf4c-8608-474c-96f5-a41fa321c333\r\nc594d0e3-b463-4088-8fcf-a7a27d3f9793", "validation_query": "select * from lo_accounts where source_system = 'Amazon Web Services (AWS)'", "description": "All passwords should require rotation or enforce minimum password length. The specific password requirements should ultimately align with your compliance policies.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://console.aws.amazon.com/iam/home?#/account_settings$editPasswordPolicy?step=passwordPolicy", "exclude_field": ""}, {"name": "[GCP] SQL Databases are backed up", "query": "select\r\n  name,\r\n  title,\r\n  backup_enabled,\r\n  self_link,\r\n  location,\r\n  project,\r\n  instance_type,\r\n  database_version,\r\n  location\r\nfrom\r\n  gcp_sql_database_instance\r\nwhere\r\n  backup_enabled = false", "source_systems": null, "control_references": "Backup tests", "control_reference_ids": "CP-02\r\nCP-09", "tag_references": "", "subtask_reference": "a5a9e199-78aa-4c06-8dbc-f995214faad8\r\n", "validation_query": "SELECT * from lo_accounts where source_system = 'Google Cloud Platform (GCP)'", "description": "This monitor verifies that your organization has a backup configuration enabled for your SQL databases. It will move to a Flagged status if no backup configurations are found. It's important to ensure that each of your SQL databases is backed up as this query only confirms that backups are being used by any database.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "<h3 id=\"from-console\" class=\"text-break\">From GCP Console</h3>\r\n<p>Select the resource and click&nbsp;<strong>Manage</strong></p>\r\n<ol>\r\n<li>Click&nbsp;<strong>Edit</strong> located next to <strong>Settings</strong>.&nbsp;</li>\r\n<li>Enable the checkbox titled <strong>Automate backups</strong>.</li>\r\n<li>Click Save.</li>\r\n</ol>", "fix_me_link": "https://console.cloud.google.com/sql/instances/$gcp_sql_database_instance.name/backups?project=$gcp_sql_database_instance.project", "exclude_field": "gcp_sql_database_instance.name"}, {"name": "[GCP] All Cloud Logs are Captured and Archived", "query": "select\r\n        service,\r\n        string_agg(log ->> 'logType', ', ') log_types,\r\n        string_agg(log ->> 'exemptedMembers', ', ') exempted_user,\r\n        project\r\n      from\r\n        gcp_audit_policy,\r\n        jsonb_array_elements(audit_log_configs) as log\r\n      group by\r\n        service, project\r\n      having string_agg(log ->> 'exemptedMembers', ', ') <> null", "source_systems": [], "control_references": "", "control_reference_ids": "AU-02", "tag_references": "", "subtask_reference": "0c9d6cae-0e9b-4ba4-b0f7-24005e84294a\r\n74a1fdf3-371e-45aa-bee1-c3483e28bce6\r\n1abcfbbe-504b-4967-b6f0-bc33b98348d2\r\nf37b28b0-58c0-4ecc-b7d7-2fe2aea91bb7", "validation_query": "SELECT * from lo_accounts where source_system = 'Google Cloud Platform (GCP)'", "description": "It is recommended that Cloud Audit Logging is configured to track all admin activities and read, write access to user data. Admin Activity logs are always enabled. They cannot be disabled. Data Access audit logs are disabled by default because they can be quite large.\r\n\r\nIt is recommended to have an effective default audit config configured in such a way that:\r\n\r\n1. Logtype is set to DATA_READ (to log user activity tracking) and DATA_WRITES (to log changes/tampering to user data).\r\n\r\n2. Audit config is enabled for all the services supported by the Data Access audit logs feature.\r\n\r\n3. Logs should be captured for all users, i.e., there are no exempted users in any of the audit config sections. This will ensure overriding the audit config will not contradict the requirement.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "<h3 id=\"from-console\" class=\"text-break\">From GCP Console</h3>\r\n<ol>\r\n<li>Login to GCP console and navigate to&nbsp;<a href=\"https://console.cloud.google.com/iam-admin/audit\">IAM &amp; Admin</a>.</li>\r\n<li>Click on&nbsp;<strong>Default Audit Config</strong>&nbsp;at the top of the page.</li>\r\n<li>In the&nbsp;<strong>LOG TYPE</strong>&nbsp;tab, select the check boxes&nbsp;<code>Admin Read</code>,&nbsp;<code>Data Read</code>, and&nbsp;<code>Data Write</code>, and click&nbsp;<strong>Save</strong>.</li>\r\n<li>In the&nbsp;<strong>EXEMPTED USERS</strong>&nbsp;tab, remove all users if any. Click&nbsp;<strong>Save</strong>.</li>\r\n</ol>\r\n<p>For more details, you can refer&nbsp;<a href=\"https://cloud.google.com/logging/docs/audit/configure-data-access\">Configuring Data Access audit logs guide</a></p>", "fix_me_link": "https://console.cloud.google.com/logs/query?authuser=0&project=$gcp_audit_policy.project", "exclude_field": ""}, {"name": "[GCP] Cloud SQL Database Instances Require SSL", "query": "select \r\n  name,\r\n  self_link,\r\n  ip_configuration,\r\n  location,\r\n  project\r\nfrom\r\n  gcp_sql_database_instance\r\nwhere\r\n  ip_configuration -> 'requireSsl' is null", "source_systems": null, "control_references": "", "control_reference_ids": "SC-13", "tag_references": "", "subtask_reference": "461d35e8-5204-4405-9117-b62eb009866f", "validation_query": "SELECT * from lo_accounts where source_system = 'Google Cloud Platform (GCP)'", "description": "It is recommended to enforce all incoming connections to SQL database instances to use SSL.\r\n\r\nSQL database connections if successfully trapped (MITM); can reveal sensitive data like credentials, database queries, query outputs etc. For security, it is recommended to always use SSL encryption when connecting to your instance.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "<p>This recommendation is applicable for PostgreSQL, MySQL generation 1, MySQL generation 2 and SQL Server 2017 instances.</p>\r\n<h3 id=\"from-console\" class=\"text-break\">From GCP Console</h3>\r\n<ol>\r\n<li>Login in to&nbsp;<a href=\"https://console.cloud.google.com/sql/instances\">Cloud SQL Instances</a></li>\r\n<li>Click on an instance name to see its configuration overview.</li>\r\n<li>In the left-side panel, select&nbsp;<code>Connections</code>.</li>\r\n<li>In the&nbsp;<code>SSL encryption</code>&nbsp;section, click&nbsp;<strong>Allow only SSL connections</strong>.</li>\r\n<li>Under&nbsp;<code>Manage server certificates</code>&nbsp;click&nbsp;<strong>Create new certificate</strong>.</li>\r\n<li>Under&nbsp;<code>Manage client certificates</code>&nbsp;click&nbsp;<strong>Create a client certificate</strong>.</li>\r\n<li>Follow the&nbsp;<a href=\"https://cloud.google.com/sql/docs/postgres/configure-ssl-instance\">instructions</a>&nbsp;shown to learn how to connect to your instance.</li>\r\n</ol>", "fix_me_link": "https://console.cloud.google.com/sql/instances/$gcp_sql_database_instance.name/connections/security?project=$gcp_sql_database_instance.project", "exclude_field": "gcp_sql_database_instance.akas"}, {"name": "[Subtasks] No recurring tasks are overdue", "query": "select task, customer_identifier, text, due_date from subtasks where program = 'Laika Compliance' and due_date < cast((now()) as date)", "source_systems": null, "control_references": "", "control_reference_ids": "", "tag_references": "", "subtask_reference": "", "validation_query": "select * from lo_accounts where source_system = 'recurring_placeholder'", "description": "This monitor watches the due dates of recurring tasks in your Laika Compliance Playbook. If any recurring task's due date is in the past, it will move into a Flagged status.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "laika_context", "take_action": "", "fix_me_link": "", "exclude_field": ""}, {"name": "[Azure] PostgreSQL Database Servers Enforce SSL Connections", "query": "select\r\n  s.subscription_id,\r\n  s.name,\r\n  s.id as resource,\r\n  s.ssl_enforcement,\r\n  s.resource_group,\r\n  sub.display_name as subscription\r\nfrom\r\n  azure_postgresql_server s,\r\n  azure_subscription sub\r\nwhere\r\n  sub.subscription_id = s.subscription_id and \r\n  ssl_enforcement = 'Disabled';", "source_systems": [], "control_references": "", "control_reference_ids": "", "tag_references": "", "subtask_reference": "461d35e8-5204-4405-9117-b62eb009866f\r\n05a8d1cc-8334-410d-b46a-81d5eb42614d\r\n7eeccf3a-f8b1-45ca-88d0-7a2ba87affa4", "validation_query": "select * from lo_accounts where source_system = 'Microsoft Azure'", "description": "A Secure Sockets Layer (SSL) certificate is a digital certificate that authenticates an identity and enables encrypted connections. It\u2019s recommended to force all connections to PostgreSQL databases to use SSL. This provides an additional layer of security by forcing clients to connect to the database (DB) using SSL. SSL connections between parties offer protection against attacks by encrypting the data sent between the two parties.\r\n\r\nThis monitor will move from Healthy to Flagged if a PostgreSQL database is found not forcing use of SSL for connections.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "<div class=\"heading-wrapper h3\">\r\n<h3 id=\"Using-the-Azure-portal\" data-renderer-start-pos=\"911\">Using the Azure portal</h3>\r\n</div>\r\n<p data-renderer-start-pos=\"935\">Select the resource and click <strong>Manage</strong></p>\r\n<ol class=\"ak-ol\" data-indent-level=\"1\">\r\n<li>\r\n<p data-renderer-start-pos=\"957\">Click on the name of your PostgreSQL server from the list</p>\r\n</li>\r\n<li>\r\n<p data-renderer-start-pos=\"984\">Click <strong data-renderer-mark=\"true\">Connection Security.</strong></p>\r\n</li>\r\n<li>\r\n<p data-renderer-start-pos=\"1014\">Use the toggle button to enable the&nbsp;<strong data-renderer-mark=\"true\">Enforce SSL connection</strong>&nbsp;setting.</p>\r\n</li>\r\n<li>\r\n<p data-renderer-start-pos=\"1085\">Click&nbsp;<strong data-renderer-mark=\"true\">Save</strong>.</p>\r\n</li>\r\n</ol>", "fix_me_link": "https://portal.azure.com/#@/resource/subscriptions/$azure_postgresql_server.subscription_id/resourceGroups/$azure_postgresql_server.resource_group/providers/Microsoft.DBforPostgreSQL/servers/$azure_postgresql_server.name/connectionSecurity", "exclude_field": "azure_postgresql_server.id"}, {"name": "[AWS] SNS topics are encrypted at rest", "query": "select\r\n  topic_arn as resource,\r\n  kms_master_key_id,\r\n  region,\r\n  account_id\r\nfrom\r\n  aws_sns_topic\r\nwhere \r\n  kms_master_key_id is null;", "source_systems": null, "control_references": "", "control_reference_ids": "", "tag_references": "", "subtask_reference": "adf335d1-b626-45c3-bc2b-d6b24e77da37\r\naef7b123-083c-41ba-8a4b-2372704a2e8d\r\n1b5d7a4c-695c-4028-800c-40497c1c9c09", "validation_query": "select * from lo_accounts where source_system = 'Amazon Web Services (AWS)'", "description": "Encrypting data at rest reduces the risk of data stored on disk being accessed by a user not authenticated to AWS. It also adds another set of access controls to limit the ability of unauthorized users to access the data. For example, API permissions are required to decrypt the data before it can be read. SNS topics should be encrypted at-rest for an added layer of security.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "<p>To remediate this issue, update your SNS topic to enable encryption.</p>\r\n<p><strong>To encrypt an unencrypted SNS topic</strong></p>\r\n<ol>\r\n<li>Open the&nbsp;<a href=\"https://console.aws.amazon.com/sns/v3/home\">Amazon SNS console</a>.</li>\r\n<li>In the navigation pane, choose&nbsp;<code>Topics</code>.</li>\r\n<li>Choose the name of the topic to encrypt.</li>\r\n<li>Choose&nbsp;<code>Edit</code>.</li>\r\n<li>Under&nbsp;<code>Encryption</code>, choose&nbsp;<code>Enable Encryption</code>.</li>\r\n<li>Choose the&nbsp;<code>KMS key</code>&nbsp;to use to encrypt the topic.</li>\r\n<li>Choose&nbsp;<code>Save</code>&nbsp;changes.</li>\r\n</ol>", "fix_me_link": "https://console.aws.amazon.com/sns/v3/home?region=$aws_sns_topic.region#/homepage", "exclude_field": "aws_sns_topic.topic_arn"}, {"name": "[AWS] CloudTrail trail logs are encrypted with KMS CMK", "query": "select\r\n  arn as resource,\r\n  region,\r\n  account_id,\r\n  kms_key_id\r\nfrom\r\n  aws_cloudtrail_trail\r\nwhere \r\n  region = home_region and kms_key_id is null;", "source_systems": null, "control_references": "", "control_reference_ids": "", "tag_references": "", "subtask_reference": "adf335d1-b626-45c3-bc2b-d6b24e77da37\r\n1b5d7a4c-695c-4028-800c-40497c1c9c09", "validation_query": "select * from lo_accounts where source_system = 'Amazon Web Services (AWS)'", "description": "Encrypting data at rest reduces the risk of data stored on disk being accessed by a user not authenticated to AWS. It also adds another set of access controls to limit the ability of unauthorized users to access the data. For example, API permissions are required to decrypt the data before it can be read. To help protect sensitive data at rest, ensure encryption is enabled for your Amazon CloudWatch Log Groups.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://console.aws.amazon.com/cloudwatch/home?region=$aws_cloudtrail_trail.region#alarmsV2:", "exclude_field": "aws_cloudtrail_trail.arn"}, {"name": "[AWS] Redshift cluster encryption in transit is enabled", "query": "select\r\n  'arn:aws:redshift:' || region || ':' || account_id || ':' || 'cluster' || ':' || cluster_identifier as resource,\r\n  region,\r\n  account_id\r\nfrom\r\n  aws_redshift_cluster,\r\n  jsonb_array_elements(cluster_parameter_groups) as cpg\r\nwhere cpg ->> 'ParameterGroupName' not in (\r\n    select\r\n      name\r\n    from\r\n      aws_redshift_parameter_group,\r\n      jsonb_array_elements(parameters) as p\r\n    where\r\n      p ->> 'ParameterName' = 'require_ssl'\r\n      and p ->> 'ParameterValue' = 'true'\r\n);", "source_systems": [], "control_references": "DCA 51 (CC6)", "control_reference_ids": "SC-13", "tag_references": "", "subtask_reference": "461d35e8-5204-4405-9117-b62eb009866f\r\n05a8d1cc-8334-410d-b46a-81d5eb42614d\r\n7eeccf3a-f8b1-45ca-88d0-7a2ba87affa4", "validation_query": "select * from lo_accounts where source_system = 'Amazon Web Services (AWS)'", "description": "Encryption of data in transit should be mandatory for any network traffic that requires authentication or includes data that is not publicly accessible, such as emails. To help protect data in transit encryption in transit should be enabled. for Redshift clusters.\r\n\r\nThis monitor will change from healthy to flagged if a Redshift cluster without encryption in transit enabled is found.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://console.aws.amazon.com/redshiftv2/home?region=$aws_redshift_cluster.region#cluster-details?cluster=cluster_identifier", "exclude_field": "aws_redshift_cluster.arn"}, {"name": "[AWS] Log group encryption at rest should be enabled", "query": "select\r\narn as resource,\r\nregion,\r\naccount_id,\r\nkms_key_id\r\nfrom\r\naws_cloudwatch_log_group\r\nwhere kms_key_id is null limit 20;", "source_systems": null, "control_references": "", "control_reference_ids": "SC-13\r\nAU-02", "tag_references": "", "subtask_reference": "1b5d7a4c-695c-4028-800c-40497c1c9c09\r\nadf335d1-b626-45c3-bc2b-d6b24e77da37\r\naef7b123-083c-41ba-8a4b-2372704a2e8d", "validation_query": "select \r\n  * \r\nfrom \r\n  lo_accounts \r\nwhere \r\n  source_system = 'Amazon Web Services (AWS)'", "description": "To help protect sensitive data at rest, ensure encryption is enabled for your Amazon CloudWatch Log Group", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://us-east-2.console.aws.amazon.com/cloudwatch/home?region=$aws_cloudwatch_log_group.region#logsV2:log-groups", "exclude_field": "aws_cloudwatch_log_group.arn"}, {"name": "[GCP] All Compute Instances use instance-specific SSH keys", "query": "select \r\nself_link, \r\nlocation, \r\nname, \r\nlabels, \r\nproject, \r\nzone_name\r\nfrom gcp_compute_instance\r\nwhere metadata -> 'items' @> '[{\"key\": \"block-project-ssh-keys\", \"value\": \"false\"}]' \r\nand not (name like 'gke-%' or labels ? 'goog-gke-node')", "source_systems": [], "control_references": "", "control_reference_ids": "", "tag_references": "", "subtask_reference": "", "validation_query": "SELECT * from lo_accounts where source_system = 'Google Cloud Platform (GCP)'", "description": "Instance specific SSH keys should be used instead of using common/shared project-wide SSH keys to access Instances. Project wide keys can be used to login into all the instances within the project. Using Instance specific SSH keys limits the attack surface if the keys are compromised.\r\n\r\nThis monitor will transition from healthy to flagged if a compute instance is found using allowing use of project-wide SSH keys.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "<h3 id=\"from-console\" class=\"text-break\">From Console</h3>\r\n<ol>\r\n<li>Login to GCP VM&nbsp;<a href=\"https://console.cloud.google.com/compute/instances\">Console</a>.</li>\r\n<li>Click on the instance name to go to its VM instance details page.</li>\r\n<li>Navigate to&nbsp;<code>SSH Keys</code>&nbsp;section to check if&nbsp;<strong>Block project-wide SSH keys</strong>&nbsp;is checked or not.</li>\r\n<li>If not, to block users with&nbsp;<code>project-wide SSH</code>&nbsp;keys from connecting to this instance, select&nbsp;<strong>Block project-wide SSH keys</strong>.</li>\r\n<li>Click Save at the bottom of the page.</li>\r\n<li>Repeat steps for every impacted Instance.</li>\r\n</ol>", "fix_me_link": "https://console.cloud.google.com/compute/instancesEdit/zones/$gcp_compute_instance.zone_name/instances/$gcp_compute_instance.name?project=$gcp_compute_instance.project", "exclude_field": "gcp_compute_instance.id"}, {"name": "[AWS] RDS DB instances have Multi AZ enabled", "query": "select arn as resource, multi_az, title, region, account_id, engine, availability_zone, secondary_availability_zone, db_instance_identifier from aws_rds_db_instance where not multi_az and engine not in ('aurora-postgresql', 'aurora-mysql')", "source_systems": [], "control_references": "", "control_reference_ids": "", "tag_references": "", "subtask_reference": "", "validation_query": "select \r\n  * \r\nfrom \r\n  lo_accounts \r\nwhere \r\n  source_system = 'Amazon Web Services (AWS)'", "description": "Multi-AZ support in Amazon Relational Database Service (Amazon RDS) provides enhanced availability and durability for production database instances.\r\n\r\nThis monitor will transition from flagged to healthy when an RDS is found without Multi AZ enabled.\r\n\r\nPlease note: Multi-AZ support for Amazon Aurora RDS is defined on the cluster level. If your company uses Aurora RDS, please reference the monitor: [AWS] Aurora RDS DB instances have Multi AZ enabled", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "<p><strong>To enable multiple Availability Zones for a DB instance</strong></p>\r\n<ol>\r\n<li>Open the&nbsp;<a href=\"https://console.aws.amazon.com/rds/\">Amazon RDS console</a>.</li>\r\n<li>In the navigation pane, choose&nbsp;<code>Databases</code>, and then choose the DB instance that you want to modify.</li>\r\n<li>Choose&nbsp;<code>Modify</code>. The&nbsp;<code>Modify DB Instance</code>&nbsp;page appears.</li>\r\n<li>Under&nbsp;<code>Instance Specifications</code>, set&nbsp;<code>Multi-AZ deployment</code>&nbsp;to&nbsp;<code>Yes</code>.</li>\r\n<li>Choose&nbsp;<code>Continue</code>&nbsp;and then check the summary of modifications.</li>\r\n<li>(Optional) Choose&nbsp;<code>Apply immediately</code>&nbsp;to apply the changes immediately. Choosing this option can cause an outage in some cases. For more information, see Using the&nbsp;<a href=\"https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.DBInstance.Modifying.html#USER_ModifyInstance.ApplyImmediately\">Apply Immediately setting</a>.</li>\r\n<li>On the confirmation page, review your changes. If they are correct, choose&nbsp;<code>Modify DB Instance</code>&nbsp;to save your changes.</li>\r\n</ol>", "fix_me_link": "https://$aws_rds_db_instance.region.console.aws.amazon.com/rds/home?region=$aws_rds_db_instance.region#database:id=$aws_rds_db_instance.db_instance_identifier;is-cluster=false;tab=configuration", "exclude_field": "aws_rds_db_instance.arn"}, {"name": "[AWS] Non-Aurora RDS DB instances have deletion protection enabled", "query": "select arn as resource, deletion_protection, region, account_id, engine from aws_rds_db_instance where not deletion_protection and engine not in ('aurora-postgresql', 'aurora-mysql')", "source_systems": [], "control_references": "", "control_reference_ids": "", "tag_references": "", "subtask_reference": "", "validation_query": "select \r\n  * \r\nfrom \r\n  lo_accounts \r\nwhere \r\n  source_system = 'Amazon Web Services (AWS)'", "description": "Enabling RDS instance deletion protection is an additional layer of protection against accidental or unauthorized database deletion.\r\n\r\nWhen deletion protection is enabled, an RDS instance cannot be deleted. Before a deletion request be fulfilled, deletion protection must be turned off.\r\n\r\nThis monitor will transition from healthy to flagged if an RDS Instance does not have deletion protection enabled.\r\n\r\nPlease note: deletion protection for Amazon Aurora RDS is defined on the cluster level. Please reference the monitor: [AWS] Aurora RDS DB clusters have deletion protection enabled.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "<p><strong>To enable deletion protection for an RDS DB instance</strong></p>\r\n<ol>\r\n<li>Open the&nbsp;<a href=\"https://console.aws.amazon.com/rds/\">Amazon RDS console</a>.</li>\r\n<li>In the navigation pane, choose&nbsp;<code>Databases</code>, then choose the DB instance that you want to modify.</li>\r\n<li>Choose&nbsp;<code>Modify</code>.</li>\r\n<li>Under&nbsp;<code>Deletion protection</code>, choose&nbsp;<code>Enable deletion protection</code>.</li>\r\n<li>Choose&nbsp;<code>Continue</code>.</li>\r\n<li>Under&nbsp;<code>Scheduling of modifications</code>, choose when to apply modifications. The options are&nbsp;<code>Apply during the next scheduled maintenance window</code>&nbsp;or&nbsp;<code>Apply immediately</code>.</li>\r\n<li>Choose&nbsp;<code>Modify DB Instance</code>.</li>\r\n</ol>", "fix_me_link": "https://console.aws.amazon.com/rds/home?region=$aws_rds_db_instance.region#modify-instance:id=$aws_rds_db_instance.db_instance_identifier", "exclude_field": "aws_rds_db_instance.arn"}, {"name": "[Azure] Compute VMs have automatic updates enabled", "query": "select\r\n vm.subscription_id,\r\n  vm.vm_id as resource,\r\n  vm.name,\r\n  vm.enable_automatic_updates,\r\n  resource_group,\r\n  sub.display_name as subscription\r\nfrom\r\n  azure_compute_virtual_machine as vm,\r\n  azure_subscription as sub\r\nwhere\r\n  sub.subscription_id = vm.subscription_id and \r\n  vm.enable_automatic_updates is null", "source_systems": [], "control_references": "", "control_reference_ids": "", "tag_references": "", "subtask_reference": "", "validation_query": "select * from lo_accounts where source_system = 'Microsoft Azure'", "description": "Compute VMs should have automatic security updates enabled. This allows missing security system updates on your servers to be monitored by Azure. This monitor will transition from healthy to flagged if a VM is found with this setting disabled.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "", "exclude_field": "azure_compute_virtual_machine.id"}, {"name": "[AWS] Auto Scaling launch config public IP should be disabled", "query": "select\r\n  launch_configuration_arn as resource,\r\n  associate_public_ip_address,\r\n  region,\r\n  account_id\r\nfrom\r\n  aws_ec2_launch_configuration\r\nwhere\r\n  associate_public_ip_address;", "source_systems": [], "control_references": "", "control_reference_ids": "", "tag_references": "", "subtask_reference": "", "validation_query": "select \r\n  * \r\nfrom \r\n  lo_accounts \r\nwhere \r\n  source_system = 'Amazon Web Services (AWS)'", "description": "To limit an organization\u2019s attack surface, EC2 auto scaling should be configured to have a private IP address. This monitor will move from healthy to flagged if an auto scaling launch has a public IP.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://console.aws.amazon.com/ec2/v2/home?region=$aws_ec2_launch_configuration.region#LaunchConfigurations:", "exclude_field": "aws_ec2_launch_configuration.akas"}, {"name": "[Azure] Storage Accounts restrict network access", "query": "select\r\n  sa.subscription_id,\r\n  sa.name,\r\n  sa.id as resource,\r\n  sa.network_rule_default_action,\r\n  resource_group,\r\n  sub.display_name as subscription\r\nfrom\r\n  azure_storage_account sa,\r\n  azure_subscription sub\r\nwhere\r\n  sub.subscription_id = sa.subscription_id and\r\n  sa.network_rule_default_action = 'Allow';", "source_systems": [], "control_references": "", "control_reference_ids": "", "tag_references": "", "subtask_reference": "", "validation_query": "select * from lo_accounts where source_system = 'Microsoft Azure'", "description": "Restricting default network access helps to provide a new layer of security since storage accounts accept connections from clients on any network. To limit access to selected networks, the default action must be changed. This monitor will transition from healthy to flagged if a storage account with a default network action of \u2018Allow\u2019 is found.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://portal.azure.com/#@/resource/subscriptions/$azure_storage_account.subscription_id/resourceGroups/$azure_storage_account.resource_group/providers/Microsoft.Storage/storageAccounts/$azure_storage_account.name/networking", "exclude_field": "azure_storage_account.id"}, {"name": "[Azure] Storage accounts should have infrastructure encryption", "query": "select\r\n  s.subscription_id,\r\n  s.id as resource,\r\n  s.name,\r\n  require_infrastructure_encryption,\r\n  resource_group,\r\n  sub.display_name as subscription\r\nfrom\r\n  azure_storage_account as s,\r\n  azure_subscription as sub\r\nwhere\r\n  sub.subscription_id = s.subscription_id and\r\n  not require_infrastructure_encryption;", "source_systems": [], "control_references": "", "control_reference_ids": "", "tag_references": "", "subtask_reference": "", "validation_query": "select * from lo_accounts where source_system = 'Microsoft Azure'", "description": "Enabling infrastructure encryption allows for a higher level of assurance that the data is secure. When infrastructure encryption is enabled, data in a storage account is encrypted twice. This monitor will transition from healthy to flagged if a storage account is not using infrastructure encryption.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://portal.azure.com/#@/resource/subscriptions/$azure_storage_account.subscription_id/resourceGroups/$azure_storage_account.resource_group/providers/Microsoft.Storage/storageAccounts/$azure_storage_account.name/accountEncryption", "exclude_field": "azure_storage_account.id"}, {"name": "[AWS] No EC2 instances stopped for longer than 30 days", "query": "select\r\n  instance_id,\r\n  arn as resource,\r\n  instance_state,\r\n  region,\r\n  account_id\r\nfrom\r\n  aws_ec2_instance \r\nwhere \r\n  instance_state in ('stopped', 'stopping') and \r\n  state_transition_time <= (current_date - interval '30' day);", "source_systems": [], "control_references": "", "control_reference_ids": "", "tag_references": "", "subtask_reference": "", "validation_query": "select \r\n  * \r\nfrom \r\n  lo_accounts \r\nwhere \r\n  source_system = 'Amazon Web Services (AWS)'", "description": "An EC2 instance that is not being actively maintained (analyzed, patched, updated) should be removed or remediated to avoid security risks. This monitor will transition from healthy to flagged if an EC2 instance has been in a stopped state for thirty days.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://us-east-2.console.aws.amazon.com/ec2/v2/home?region=$aws_ec2_instance.region#InstanceDetails:instanceId=i-$aws_ec2_instance.instance_id", "exclude_field": "aws_ec2_instance.arn"}, {"name": "[Azure] MySQL Servers have SSL enabled", "query": "select\r\ns.subscription_id,\r\ns.name,\r\n  s.id as resource,\r\n  ssl_enforcement,\r\n  s.resource_group,\r\n  sub.display_name as subscription\r\nfrom\r\n  azure_mysql_server as s,\r\n  azure_subscription as sub\r\nwhere\r\n  sub.subscription_id = s.subscription_id and\r\n  ssl_enforcement = 'Disabled';", "source_systems": [], "control_references": "", "control_reference_ids": "", "tag_references": "", "subtask_reference": "", "validation_query": "select * from lo_accounts where source_system = 'Microsoft Azure'", "description": "Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://portal.azure.com/#@/resource/subscriptions/$azure_mysql_server.subscription_id/resourceGroups/$azure_mysql_server.resource_group/providers/Microsoft.DBforMySQL/servers/$azure_mysql_server.name/connectionSecurity", "exclude_field": "azure_mysql_server.id"}, {"name": "[Azure] MySQL infrastructure encryption is enabled", "query": "select\r\n  s.id as resource,\r\n  infrastructure_encryption,\r\n  resource_group,\r\n  sub.display_name as subscription,\r\n  s.location,\r\n  s.region,\r\n  s.title,\r\n  s.type\r\nfrom\r\n  azure_mysql_server as s,\r\n  azure_subscription as sub\r\nwhere\r\n  sub.subscription_id = s.subscription_id and\r\n  not infrastructure_encryption = 'Enabled';", "source_systems": [], "control_references": "", "control_reference_ids": "", "tag_references": "", "subtask_reference": "", "validation_query": "select * from lo_accounts where source_system = 'Microsoft Azure'", "description": "Enable infrastructure encryption for Azure Database for MySQL servers to have a higher level of assurance that the data is secure. When infrastructure encryption is enabled, the data at rest is encrypted twice using FIPS 140-2 compliant Microsoft managed keys. This monitor will transition from healthy to flagged if a MySQL server does not have infrastructure encryption enabled.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.DBforMySQL%2Fservers", "exclude_field": "azure_mysql_server.id"}, {"name": "[AWS] EC2 instances are not publicly available", "query": "select\r\n  arn as resource,\r\n  instance_id,\r\n  public_ip_address,\r\n  region,\r\n  instance_state,\r\n  account_id\r\nfrom\r\n  aws_ec2_instance\r\nwhere\r\n  public_ip_address is not null\r\n  and instance_state <> 'terminated'", "source_systems": [], "control_references": "", "control_reference_ids": "", "tag_references": "", "subtask_reference": "", "validation_query": "select \r\n  * \r\nfrom \r\n  lo_accounts \r\nwhere \r\n  source_system = 'Amazon Web Services (AWS)'", "description": "In order to help limit the attack surface and protect sensitive data, EC2 instances should not be publicly accessible. This monitor will move from healthy to flagged if an EC2 instance is found that has a public IP address.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://console.aws.amazon.com/ec2/v2/home?region=aws_ec2_instance.region#Instances:instanceState=running", "exclude_field": "aws_ec2_instance.arn"}, {"name": "[AWS] EC2 instances are in VPCs", "query": "select\r\n  arn as resource,\r\n  vpc_id,\r\n  region,\r\n  instance_state,\r\n  account_id\r\nfrom\r\n  aws_ec2_instance\r\nwhere\r\n  vpc_id is null\r\nand instance_state <> 'terminated'", "source_systems": [], "control_references": "", "control_reference_ids": "", "tag_references": "", "subtask_reference": "", "validation_query": "select \r\n  * \r\nfrom \r\n  lo_accounts \r\nwhere \r\n  source_system = 'Amazon Web Services (AWS)'", "description": "Deploying Amazon Elastic Compute Cloud (Amazon EC2) instances within an Amazon Virtual Private Cloud (Amazon VPC) enables secure communication between an instance and other services within the amazon VPC, without requiring an internet access. This monitor will transition from healthy to flagged if an EC2 instance is not in a VPC.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://$aws_ec2_instance.region.console.aws.amazon.com/ec2/v2/home?region=$aws_ec2_instance.region#InstanceDetails:instanceId=$aws_ec2_instance.instance_id", "exclude_field": "aws_ec2_instance.arn"}, {"name": "[Azure] MariaDB Servers have public access disabled", "query": "select\r\n  s.subscription_id,\r\n  s.name,\r\n  s.id as resource,\r\n  public_network_access,\r\n  resource_group,\r\n  sub.display_name as subscription\r\nfrom\r\n  azure_mariadb_server as s,\r\n  azure_subscription as sub\r\nwhere\r\n  sub.subscription_id = s.subscription_id and\r\n  not public_network_access = 'Enabled';", "source_systems": [], "control_references": "", "control_reference_ids": "", "tag_references": "", "subtask_reference": "", "validation_query": "select * from lo_accounts where source_system = 'Microsoft Azure'", "description": "Disabling public network access to MariaDB servers improves security and ensures databases can only be accessed from private endpoints. This monitor will transition from healthy to flagged if a MariaDB server is found that is publicly accessible.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://portal.azure.com/#@/resource/subscriptions/$azure_mariadb_server.subscription_id/resourceGroups/$azure_mariadb_server.resource_group/providers/Microsoft.DBforMariaDB/servers/$azure_mariadb_server.name/connectionSecurity", "exclude_field": "azure_mariadb_server.id"}, {"name": "[AWS] EC2 Instances have detailed monitoring enabled", "query": "select\r\n  instance_id,\r\n  arn as resource,\r\n  monitoring_state,\r\n  region,\r\n  instance_state,\r\n  account_id\r\nfrom\r\n  aws_ec2_instance\r\nwhere\r\n  monitoring_state = 'disabled'\r\n  and instance_state <> 'terminated'", "source_systems": [], "control_references": "", "control_reference_ids": "", "tag_references": "", "subtask_reference": "", "validation_query": "select \r\n  * \r\nfrom \r\n  lo_accounts \r\nwhere \r\n  source_system = 'Amazon Web Services (AWS)'", "description": "EC2 instances should have detailed monitoring enabled. This allows for monitoring graphs to be displayed for each EC2 instance. This monitor will transition from health to flagged if an EC2 instance does not have detailed monitoring enabled.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://console.aws.amazon.com/ec2/v2/home?region=aws_ec2_instance.region#Instances:instanceState=running", "exclude_field": "aws_ec2_instance.arn"}, {"name": "[AWS] EBS volume encryption at rest enabled", "query": "select\r\n  arn as resource,\r\n  encrypted,\r\n  region,\r\n  account_id\r\nfrom\r\n  aws_ebs_volume\r\nwhere\r\n  not encrypted;", "source_systems": [], "control_references": "", "control_reference_ids": "SC-13", "tag_references": "", "subtask_reference": "", "validation_query": "select \r\n  * \r\nfrom \r\n  lo_accounts \r\nwhere \r\n  source_system = 'Amazon Web Services (AWS)'", "description": "Encrypting data at rest reduces the likelihood that it is unintentionally exposed and can nullify the impact of disclosure if the encryption remains unbroken. This monitor will transition from healthy to flagged if an EBS volume does not have encryption at rest enabled.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://console.aws.amazon.com/ec2/v2/home?region=$aws_ebs_volume.region#VolumeDetails:volumeId=$aws_ebs_volume.volume_id", "exclude_field": "aws_ebs_volume.arn"}, {"name": "[Azure] Keyvault Vaults disallow public network access", "query": "select\r\n  a.id as resource,\r\n  network_acls,\r\n  resource_group,\r\n  sub.display_name as subscription\r\nfrom\r\n  azure_key_vault a,\r\n  azure_subscription sub\r\nwhere\r\n  network_acls is null or network_acls ->> 'defaultAction' != 'Deny';", "source_systems": [], "control_references": "", "control_reference_ids": "", "tag_references": "", "subtask_reference": "", "validation_query": "select * from lo_accounts where source_system = 'Microsoft Azure'", "description": "In order to reduce risks associated with key vaults, each keyvault vault should disallow public network access. This monitor will transition from health to flagged if a keyvault vault allows public access.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.KeyVault%2Fvaults", "exclude_field": "azure_key_vault.id"}, {"name": "[AWS] Redshift clusters automatically upgrade major versions", "query": "select\r\n  'arn:aws:redshift:' || region || ':' || account_id || ':' || 'cluster' || ':' || cluster_identifier as resource,\r\n  allow_version_upgrade,\r\n  region,\r\n  account_id\r\nfrom\r\n  aws_redshift_cluster\r\nwhere \r\n  not allow_version_upgrade;", "source_systems": null, "control_references": "", "control_reference_ids": "", "tag_references": "", "subtask_reference": "", "validation_query": "select \r\n  * \r\nfrom \r\n  lo_accounts \r\nwhere \r\n  source_system = 'Amazon Web Services (AWS)'", "description": "Enabling automatic major version upgrades ensures that the latest major version updates to Amazon Redshift clusters are installed during the maintenance window. This monitor will transition from healthy to flagged if a Redshift cluster is found without auto-upgrades enabled.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://console.aws.amazon.com/redshiftv2/home?region=$aws_redshift_cluster.region#clusters", "exclude_field": "aws_redshift_cluster.arn"}, {"name": "[Azure] keyvault soft delete enabled", "query": "select\r\n  kv.id as resource,\r\n  soft_delete_enabled\r\n  resource_group,\r\n  sub.display_name as subscription\r\nfrom\r\n  azure_key_vault as kv,\r\n  azure_subscription as sub\r\nwhere\r\n  sub.subscription_id = kv.subscription_id and\r\n  not soft_delete_enabled;", "source_systems": [], "control_references": "", "control_reference_ids": "", "tag_references": "", "subtask_reference": "", "validation_query": "select * from lo_accounts where source_system = 'Microsoft Azure'", "description": "Deleting a key vault without soft delete enabled permanently deletes all secrets, keys, and certificates stored in the key vault. Accidental deletion of a key vault can lead to permanent data loss. This monitor will transition from healthy to flagged if a keyvault does not have soft delete enabled.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://portal.azure.com/#@/resource/subscriptions/$azure_key_vault.subscription_id/resourceGroups/$azure_key_vault.resource_group/providers/Microsoft.KeyVault/vaults/$azure_key_vault.name/properties", "exclude_field": "azure_key_vault.id"}, {"name": "[AWS] Redshift clusters retain backups for at least 7 days", "query": "select\r\n  cluster_identifier,\r\n  'arn:aws:redshift:' || region || ':' || account_id || ':' || 'cluster' || ':' || cluster_identifier as resource,\r\n  automated_snapshot_retention_period,\r\n  region,\r\n  account_id\r\nfrom\r\n  aws_redshift_cluster\r\nwhere\r\n  automated_snapshot_retention_period < 7;", "source_systems": [], "control_references": "", "control_reference_ids": "", "tag_references": "", "subtask_reference": "", "validation_query": "select \r\n  * \r\nfrom \r\n  lo_accounts \r\nwhere \r\n  source_system = 'Amazon Web Services (AWS)'", "description": "Backups aid in recovery after a security incident and strengthen the resilience of systems. Amazon Redshift takes periodic snapshots by default. This monitor will transition from healthy to flagged if a redshift cluster is found without backups that are retained for at least seven days.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://console.aws.amazon.com/redshiftv2/home?region=$aws_redshift_cluster.region#cluster-details?cluster=$aws_redshift_cluster.cluster_identifier", "exclude_field": "aws_redshift_cluster.arn"}, {"name": "[AWS] RDS DB automatically upgrades minor version", "query": "select\r\n  db_instance_identifier,\r\n  arn as resource,\r\n  auto_minor_version_upgrade,\r\n  region,\r\n  account_id\r\nfrom\r\n  aws_rds_db_instance\r\nwhere\r\n  not auto_minor_version_upgrade;", "source_systems": [], "control_references": "", "control_reference_ids": "", "tag_references": "", "subtask_reference": "", "validation_query": "select \r\n  * \r\nfrom \r\n  lo_accounts \r\nwhere \r\n  source_system = 'Amazon Web Services (AWS)'", "description": "Enabling automatic minor version upgrades ensures that the latest minor version updates to relational database management systems (RDBMS) are installed. These upgrades might include security patches and bug fixes. This monitor will transition from healthy to flagged if an RDS DB is found without auto-upgrades for minor releases enabled.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://console.aws.amazon.com/rds/home?region=$aws_rds_db_instance.region#database:id=$aws_rds_db_instance.db_instance_identifier;is-cluster=false;tab=maintenance-and-backups", "exclude_field": "aws_rds_db_instance.arn"}, {"name": "[Azure] Keyvault Secrets have expiration set", "query": "select\r\n  kvs.id as resource,\r\n  kvs.enabled,\r\n  kvs.expires_at,\r\n  kvs.resource_group,\r\n  sub.display_name as subscription\r\nfrom\r\n  azure_key_vault_secret as kvs,\r\n  azure_subscription as sub\r\nwhere\r\n  sub.subscription_id = kvs.subscription_id and\r\n  (expires_at is not null or\r\n  not enabled);", "source_systems": [], "control_references": "", "control_reference_ids": "", "tag_references": "", "subtask_reference": "", "validation_query": "select * from lo_accounts where source_system = 'Microsoft Azure'", "description": "It is recommended that all\u00a0Secrets\u00a0in the Azure Key Vault have an expiration time set. This monitor will transition from healthy to flagged if a keyvault secret does not have an expiration date.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.KeyVault%2Fvaults", "exclude_field": "azure_key_vault_secret.id"}, {"name": "[AWS] Aurora RDS DB clusters have deletion protection enabled", "query": "select \r\ndb_cluster_identifier, \r\narn as resource, \r\ndeletion_protection, \r\nregion, \r\naccount_id, \r\nengine \r\nfrom aws_rds_db_cluster \r\nwhere not deletion_protection and engine in ('aurora-postgresql', 'aurora-mysql')", "source_systems": [], "control_references": "", "control_reference_ids": "", "tag_references": "", "subtask_reference": "", "validation_query": "select \r\n  * \r\nfrom \r\n  lo_accounts \r\nwhere \r\n  source_system = 'Amazon Web Services (AWS)'", "description": "Enabling instance deletion protection is an additional layer of protection against accidental database deletion or deletion by an unauthorized entity. While this is enabled, a DB cluster cannot be deleted. This monitor will transition from healthy to flagged if an RDS DB cluster is found without deletion protection enabled.\r\n\r\nPlease note: deletion protection for Amazon Aurora RDS is defined on the cluster level. If your company uses RDS other than Aurora, Please reference the monitor: [AWS] RDS DB instances have deletion protection enabled.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://console.aws.amazon.com/rds/home?region=$aws_rds_db_cluster.region#database:id=$aws_rds_db_cluster.db_cluster_identifier;is-cluster=true;tab=configuration", "exclude_field": "aws_rds_db_cluster.arn"}, {"name": "[Azure] Redis caches are in virtual networks", "query": "select\r\n  redis.id as resource,\r\n  redis.subnet_id,\r\n  redis.resource_group,\r\n  sub.display_name as subscription\r\nfrom\r\n  azure_redis_cache as redis,\r\n  azure_subscription as sub\r\nwhere\r\n  sub.subscription_id = redis.subscription_id and\r\n  subnet_id is null;", "source_systems": [], "control_references": "", "control_reference_ids": "", "tag_references": "", "subtask_reference": "", "validation_query": "select * from lo_accounts where source_system = 'Microsoft Azure'", "description": "Azure Virtual Network Deployment provides enhanced security and isolation for your Azure Cache for Redis, as well as subnets, access control policies, and other features to further restrict access. This monitor will transition from healthy to flagged if a Redis cache is not in a virtual network.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://portal.azure.com/#@/resource/subscriptions/$azure_subscription.id/resourceGroups/$azure_redis_cache.resource_group/providers/Microsoft.Cache/Redis/$azure_redis_cache.name/overview", "exclude_field": "azure_redis_cache.id"}, {"name": "[GCP] Compute Instances have shielded VM enabled", "query": "select self_link resource, shielded_instance_config, location, project \r\nfrom gcp_compute_instance \r\nwhere shielded_instance_config = '{\"enableVtpm\": false, \"enableIntegrityMonitoring\": true}' \r\nor shielded_instance_config = '{\"enableVtpm\": true, \"enableIntegrityMonitoring\": false}' \r\nor shielded_instance_config = '{\"enableVtpm\": false, \"enableIntegrityMonitoring\": false}'\r\nor shielded_instance_config = '{}';", "source_systems": [], "control_references": "", "control_reference_ids": "", "tag_references": "", "subtask_reference": "", "validation_query": "SELECT * from lo_accounts where source_system = 'Google Cloud Platform (GCP)'", "description": "Shielded VMs are virtual machines (VMs) on Google Cloud Platform hardened by a set of security controls that help defend against rootkits and bootkits. This monitor will transition from healthy to flagged if a Compute Instance is found without shielding enabled.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://console.cloud.google.com/compute/instancesEdit/zones/$gcp_compute_instance.zone_name/instances/$gcp_compute_instance.name?project=$gcp_compute_instance.project", "exclude_field": ""}, {"name": "[GCP] Compute Instances have confidential computing enabled", "query": "select\r\n  id,\r\n  self_link resource,\r\n  confidential_instance_config,\r\n  location,\r\n  project,\r\n  name,\r\n  zone_name\r\nfrom\r\n  gcp_compute_instance\r\nwhere\r\n  confidential_instance_config @> '{\"enableConfidentialCompute\": false}' or\r\n  confidential_instance_config is null or confidential_instance_config = '{}';", "source_systems": [], "control_references": "", "control_reference_ids": "", "tag_references": "", "subtask_reference": "", "validation_query": "SELECT * from lo_accounts where source_system = 'Google Cloud Platform (GCP)'", "description": "Confidential Computing enables customers' sensitive code and other data encrypted in memory during processing. This can help alleviate concerns about risk related to either dependency on Google infrastructure or Google insiders' access to customer data in the clear. This monitor will move from healthy to flagged if a compute instance is found without confidential computing enabled.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://console.cloud.google.com/compute/instancesEdit/zones/$gcp_compute_instance.zone_name/instances/$gcp_compute_instance.name?project=$gcp_compute_instance.project", "exclude_field": "gcp_compute_instance.id"}, {"name": "[GCP] Compute Instances disable serial port connections", "query": "select\r\n  self_link resource,\r\n  metadata -> 'items' as serial_console,\r\n  location,\r\n  zone_name,\r\n  name,\r\n  project\r\nfrom\r\n  gcp_compute_instance\r\nwhere \r\n  metadata -> 'items' @> '[{\"key\": \"serial-port-enable\", \"value\": \"true\"}]' or \r\n  metadata -> 'items' is null;", "source_systems": [], "control_references": "Firewall Configuration and Monitoring", "control_reference_ids": "", "tag_references": "", "subtask_reference": "", "validation_query": "SELECT * from lo_accounts where source_system = 'Google Cloud Platform (GCP)'", "description": "The interactive serial console does not support IP-based access restrictions. If enabled on an instance, clients can attempt to connect from any IP address. This allows anybody to connect to that instance if they know the correct SSH key, username, project ID, zone, and instance name. This monitor will transition from healthy to flagged if a compute instance is found with the serial console enabled.", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "", "fix_me_link": "https://console.cloud.google.com/compute/instancesEdit/zones/$gcp_compute_instance.zone_name/instances/$gcp_compute_instance.name?project=$gcp_compute_instance.project", "exclude_field": "gcp_compute_instance.id"}, {"name": "[AWS] Aurora RDS DB clusters have Multi AZ enabled", "query": "select \r\narn as resource, \r\nmulti_az, \r\nengine, \r\ntitle, \r\nregion, \r\naccount_id\r\nfrom aws_rds_db_cluster \r\nwhere not multi_az and engine in ('aurora-postgresql', 'aurora-mysql')", "source_systems": [], "control_references": "", "control_reference_ids": "", "tag_references": "", "subtask_reference": "", "validation_query": "select * from lo_accounts where source_system = 'Amazon Web Services (AWS)'", "description": "Multi-AZ support in Amazon Relational Database Service (Amazon RDS) provides enhanced availability and durability for production database instances.\r\n\r\nThis monitor will transition from flagged to healthy when an RDS is found without Multi-AZ enabled.\r\n\r\nPlease note: Multi-AZ support for Amazon Aurora RDS is defined on the cluster level. If your company does not use Aurora RDS, please reference the monitor: [AWS] RDS DB instances have Multi AZ enabled", "monitor_type": "system_monitor", "urgency": "low", "status": "active", "health_condition": "empty_results", "frequency": "daily", "runner_type": "on_demand", "take_action": "<p><strong>To enable multiple Availability Zones for a DB instance</strong></p>\r\n<ol>\r\n<li>Open the&nbsp;<a href=\"https://console.aws.amazon.com/rds/\">Amazon RDS console</a>.</li>\r\n<li>In the navigation pane, choose&nbsp;<code>Databases</code>, and then choose the DB instance that you want to modify.</li>\r\n<li>Choose&nbsp;<code>Modify</code>. The&nbsp;<code>Modify DB Instance</code>&nbsp;page appears.</li>\r\n<li>Under&nbsp;<code>Instance Specifications</code>, set&nbsp;<code>Multi-AZ deployment</code>&nbsp;to&nbsp;<code>Yes</code>.</li>\r\n<li>Choose&nbsp;<code>Continue</code>&nbsp;and then check the summary of modifications.</li>\r\n<li>(Optional) Choose&nbsp;<code>Apply immediately</code>&nbsp;to apply the changes immediately. Choosing this option can cause an outage in some cases. For more information, see Using the&nbsp;<a href=\"https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.DBInstance.Modifying.html#USER_ModifyInstance.ApplyImmediately\">Apply Immediately setting</a>.</li>\r\n<li>On the confirmation page, review your changes. If they are correct, choose&nbsp;<code>Modify DB Instance</code>&nbsp;to save your changes.</li>\r\n</ol>", "fix_me_link": "https://$aws_rds_db_cluster.region.console.aws.amazon.com/rds/home?region=$aws_rds_db_cluster.region#database:id=$aws_rds_db_cluster.db_cluster_identifier;is-cluster=true;tab=connectivity", "exclude_field": "aws_rds_db_cluster.arn"}]
from pathlib import Path

import pytest

from organization.tests import create_organization
from pentest.models import PentestRequest
from user.tests import create_user

FILE_NAME = 'attachment.png'


@pytest.fixture
def pentest_request():
    organization = create_organization(name='Test')
    user = create_user(organization, email='admin@heylaika.com')
    yield PentestRequest.objects.create(
        created_by=user,
        organization=organization,
        name='Pentest Name',
        target_date='2022-02-09',
    )


@pytest.fixture
def attachment_report():
    attachment_path = Path(__file__).parent / f'mock_files/{FILE_NAME}'
    with open(attachment_path, 'rb') as file:
        yield file

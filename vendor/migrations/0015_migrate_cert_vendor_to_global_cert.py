# Generated by Django 3.0.7 on 2020-07-13 22:23

from django.db import migrations


def migrate_cert_vendor_to_global_cert(apps, schema_editor):
    GlobalCertification = apps.get_model('certification', 'Certification')
    Certification = apps.get_model('vendor', 'Certification')
    CertificationVendor = apps.get_model('vendor', 'CertificationVendor')
    VendorCertification = apps.get_model('vendor', 'VendorCertification')
    Vendor = apps.get_model('vendor', 'Vendor')

    for cert_vendor in CertificationVendor.objects.all():
        certification = Certification.objects.get(pk=cert_vendor.certification.id)
        global_certification = GlobalCertification.objects.get(name=certification.name)
        vendor = Vendor.objects.get(pk=cert_vendor.vendor.id)
        VendorCertification.objects.create(
            certification=global_certification, vendor=vendor, url=cert_vendor.url
        )


class Migration(migrations.Migration):
    dependencies = [
        ('vendor', '0014_new_certification_fks'),
    ]

    operations = [migrations.RunPython(migrate_cert_vendor_to_global_cert)]

# Generated by Django 3.2.13 on 2022-06-10 03:17

import logging

from django.db import migrations, models

logger = logging.getLogger(__name__)


VERY_HIGH_RISK = 'very high'
CRITICAL_RISK = 'critical'


def _update_very_high_risk_to_critical(apps, schema_editor):
    OrganizationVendor = apps.get_model('vendor', 'OrganizationVendor')
    vendors_updated = OrganizationVendor.objects.filter(
        risk_rating=VERY_HIGH_RISK
    ).update(risk_rating=CRITICAL_RISK)
    logger.info(f'Organization vendors updated to Critical risk {vendors_updated}')


class Migration(migrations.Migration):
    dependencies = [
        ('vendor', '0030_add_very_high_risk_rating'),
    ]

    operations = [
        migrations.AlterField(
            model_name='organizationvendor',
            name='risk_rating',
            field=models.CharField(
                blank=True,
                choices=[
                    ('low', 'Low'),
                    ('medium', 'Medium'),
                    ('high', 'High'),
                    ('critical', 'Critical'),
                ],
                max_length=10,
            ),
        ),
        migrations.RunPython(_update_very_high_risk_to_critical),
    ]
